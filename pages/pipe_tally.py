# Form implementation generated from reading ui file 'ui/pipe_tally.ui'
#
# Created by: PyQt6 UI code generator 6.7.0
#
# WARNING: Any manual changes made to this file will be lost when pyuic6 is
# run again.  Do not edit this file unless you know what you are doing.

import sys
from PyQt6.QtWidgets import QApplication, QMainWindow, QTableWidget, QTableWidgetItem, QVBoxLayout, QWidget, QFileDialog
from PyQt6 import QtCore, QtGui, QtWidgets
from openpyxl import load_workbook
import pandas as pd
from PyQt6.QtWidgets import QFileDialog

class Ui_PipeTally(object):
    def setupUi(self, PipeTally):
        PipeTally.setObjectName("PipeTally")
        PipeTally.resize(500, 500)
        PipeTally.move(750, 50)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(PipeTally.sizePolicy().hasHeightForWidth())
        PipeTally.setSizePolicy(sizePolicy)
        self.verticalLayoutWidget = QtWidgets.QWidget(parent=PipeTally)
        self.verticalLayoutWidget.setGeometry(QtCore.QRect(10, 0, 1250, 700))
        self.verticalLayoutWidget.setObjectName("verticalLayoutWidget")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.verticalLayoutWidget)
        self.verticalLayout.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout.setObjectName("verticalLayout")
        self.listWidget = QtWidgets.QListWidget(parent=self.verticalLayoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Minimum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.listWidget.sizePolicy().hasHeightForWidth())
        self.listWidget.setSizePolicy(sizePolicy)
        self.listWidget.setAutoScrollMargin(15)
        self.listWidget.setSelectionMode(QtWidgets.QAbstractItemView.SelectionMode.MultiSelection)
        self.listWidget.setObjectName("listWidget")
        item = QtWidgets.QListWidgetItem()
        font = QtGui.QFont()
        font.setFamily("Calibri")
        font.setPointSize(12)
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        brush = QtGui.QBrush(QtGui.QColor(0, 0, 0))
        brush.setStyle(QtCore.Qt.BrushStyle.SolidPattern)
        item.setForeground(brush)
        item.setFlags(QtCore.Qt.ItemFlag.ItemIsDragEnabled|QtCore.Qt.ItemFlag.ItemIsEnabled)
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        item = QtWidgets.QListWidgetItem()
        self.listWidget.addItem(item)
        self.verticalLayout.addWidget(self.listWidget)
        self.tableWidget = QtWidgets.QTableWidget(parent=self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setStyleStrategy(QtGui.QFont.StyleStrategy.PreferDefault)
        self.tableWidget.setFont(font)
        self.tableWidget.setObjectName("tableWidget")
        self.tableWidget.setColumnCount(18)
        self.tableWidget.setRowCount(20)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(8, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(9, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(10, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(11, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(12, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(13, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(14, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(15, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(16, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(17, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(18, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(19, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(8, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(9, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(10, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(11, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(12, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(13, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(14, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(15, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(16, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignmentFlag.AlignJustify|QtCore.Qt.AlignmentFlag.AlignVCenter)
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(17, item)
        self.verticalLayout.addWidget(self.tableWidget)

        self.retranslateUi(PipeTally)
        self.listWidget.setCurrentRow(-1)
        QtCore.QMetaObject.connectSlotsByName(PipeTally)
        # Load Excel Data button
        self.loadButton = QtWidgets.QPushButton("Load Excel Data", self.verticalLayoutWidget)
        self.loadButton.clicked.connect(self.load_excel_data)
        self.verticalLayout.addWidget(self.loadButton)
         # Set up the signal-slot connection for listWidget selection
        self.listWidget.itemSelectionChanged.connect(self.applyFilter)


    def applyFilter(self):
        # Get all selected feature identifications from the listWidget
        selected_items = [item.text() for item in self.listWidget.selectedItems()]
        
        # Iterate over the rows of the table
        for row in range(self.tableWidget.rowCount()):
            # Get the value of the "Feature Identification" column (column index 4)
            feature_value = self.tableWidget.item(row, 4).text()

            # Check if the current feature value matches any of the selected items
            if "All" in selected_items or feature_value in selected_items:
                # Show the row if it matches
                self.tableWidget.setRowHidden(row, False)
            else:
                # Hide the row if it doesn't match
                self.tableWidget.setRowHidden(row, True)
    def retranslateUi(self, PipeTally):
        _translate = QtCore.QCoreApplication.translate
        PipeTally.setWindowTitle(_translate("PipeTally", "Form"))
        __sortingEnabled = self.listWidget.isSortingEnabled() 
        self.listWidget.setSortingEnabled(False)
        item = self.listWidget.item(0)
        item.setText(_translate("PipeTally", "Select Feature Identification"))
        item = self.listWidget.item(1)
        item.setText(_translate("PipeTally", "All"))
        item = self.listWidget.item(2)
        item.setText(_translate("PipeTally", "Bend"))
        item = self.listWidget.item(3)
        item.setText(_translate("PipeTally", "Bend (S)"))
        item = self.listWidget.item(4)
        item.setText(_translate("PipeTally", "Blind"))
        item = self.listWidget.item(5)
        item.setText(_translate("PipeTally", "Casting End"))
        item = self.listWidget.item(6)
        item.setText(_translate("PipeTally", "Casting Start"))
        item = self.listWidget.item(7)
        item.setText(_translate("PipeTally", "Clamp"))
        item = self.listWidget.item(8)
        item.setText(_translate("PipeTally", "Corrosion"))
        item = self.listWidget.item(9)
        item.setText(_translate("PipeTally", "Covering End"))
        item = self.listWidget.item(10)
        item.setText(_translate("PipeTally", "Covering Start"))
        item = self.listWidget.item(11)
        item.setText(_translate("PipeTally", "Dent "))
        item = self.listWidget.item(12)
        item.setText(_translate("PipeTally", "Flange"))
        item = self.listWidget.item(13)
        item.setText(_translate("PipeTally", "Flow Tee"))
        item = self.listWidget.item(14)
        item.setText(_translate("PipeTally", "IJ"))
        item = self.listWidget.item(15)
        item.setText(_translate("PipeTally", "Magnet"))
        item = self.listWidget.item(16)
        item.setText(_translate("PipeTally", "Metal Gain"))
        item = self.listWidget.item(17)
        item.setText(_translate("PipeTally", "PG"))
        item = self.listWidget.item(18)
        item.setText(_translate("PipeTally", "PSV"))
        item = self.listWidget.item(19)
        item.setText(_translate("PipeTally", "Sleeve"))
        item = self.listWidget.item(20)
        item.setText(_translate("PipeTally", "Support"))
        item = self.listWidget.item(21)
        item.setText(_translate("PipeTally", "Unidentified End"))
        item = self.listWidget.item(22)
        item.setText(_translate("PipeTally", "Unidentified Feature"))
        item = self.listWidget.item(23)
        item.setText(_translate("PipeTally", "Unidentified Start"))
        item = self.listWidget.item(24)
        item.setText(_translate("PipeTally", "Valve"))
        item = self.listWidget.item(25)
        item.setText(_translate("PipeTally", "Vent"))
        item = self.listWidget.item(26)
        item.setText(_translate("PipeTally", "(Blanks)"))
        self.listWidget.setSortingEnabled(__sortingEnabled)
        item = self.tableWidget.verticalHeaderItem(0)
        item.setText(_translate("PipeTally", "Index"))
        item = self.tableWidget.verticalHeaderItem(1)
        item.setText(_translate("PipeTally", "1"))
        item = self.tableWidget.verticalHeaderItem(2)
        item.setText(_translate("PipeTally", "2"))
        item = self.tableWidget.verticalHeaderItem(3)
        item.setText(_translate("PipeTally", "3"))
        item = self.tableWidget.verticalHeaderItem(4)
        item.setText(_translate("PipeTally", "4"))
        item = self.tableWidget.verticalHeaderItem(5)
        item.setText(_translate("PipeTally", "5"))
        item = self.tableWidget.verticalHeaderItem(6)
        item.setText(_translate("PipeTally", "6"))
        item = self.tableWidget.verticalHeaderItem(7)
        item.setText(_translate("PipeTally", "7"))
        item = self.tableWidget.verticalHeaderItem(8)
        item.setText(_translate("PipeTally", "8"))
        item = self.tableWidget.verticalHeaderItem(9)
        item.setText(_translate("PipeTally", "9"))
        item = self.tableWidget.verticalHeaderItem(10)
        item.setText(_translate("PipeTally", "10"))
        item = self.tableWidget.verticalHeaderItem(11)
        item.setText(_translate("PipeTally", "11"))
        item = self.tableWidget.verticalHeaderItem(12)
        item.setText(_translate("PipeTally", "12"))
        item = self.tableWidget.verticalHeaderItem(13)
        item.setText(_translate("PipeTally", "13"))
        item = self.tableWidget.verticalHeaderItem(14)
        item.setText(_translate("PipeTally", "14"))
        item = self.tableWidget.verticalHeaderItem(15)
        item.setText(_translate("PipeTally", "15"))
        item = self.tableWidget.verticalHeaderItem(16)
        item.setText(_translate("PipeTally", "16"))
        item = self.tableWidget.verticalHeaderItem(17)
        item.setText(_translate("PipeTally", "17"))
        item = self.tableWidget.verticalHeaderItem(18)
        item.setText(_translate("PipeTally", "18"))
        item = self.tableWidget.verticalHeaderItem(19)
        item.setText(_translate("PipeTally", "20"))
        item = self.tableWidget.horizontalHeaderItem(0)
        item.setText(_translate("PipeTally", "Abs. Distance (m)\n"
""))
        item = self.tableWidget.horizontalHeaderItem(1)
        item.setText(_translate("PipeTally", "Distance to U/S GW(m)"))
        item = self.tableWidget.horizontalHeaderItem(2)
        item.setText(_translate("PipeTally", "Pipe Number\n"
""))
        item = self.tableWidget.horizontalHeaderItem(3)
        item.setText(_translate("PipeTally", "Pipe Length(m)\n"
""))
        item = self.tableWidget.horizontalHeaderItem(4)
        item.setText(_translate("PipeTally", "Feature Identification\n"
""))
        item = self.tableWidget.horizontalHeaderItem(5)
        item.setText(_translate("PipeTally", "Feature Type\n"
""))
        item = self.tableWidget.horizontalHeaderItem(6)
        item.setText(_translate("PipeTally", "Dimensions  Classification\n"
""))
        item = self.tableWidget.horizontalHeaderItem(7)
        item.setText(_translate("PipeTally", "Orientation o\' clock\n"
""))
        item = self.tableWidget.horizontalHeaderItem(8)
        item.setText(_translate("PipeTally", "Length(mm)\n"
""))
        item = self.tableWidget.horizontalHeaderItem(9)
        item.setText(_translate("PipeTally", "Width(mm)\n"
""))
        item = self.tableWidget.horizontalHeaderItem(10)
        item.setText(_translate("PipeTally", "WT (mm)\n"
""))
        item = self.tableWidget.horizontalHeaderItem(11)
        item.setText(_translate("PipeTally", "Depth % \n"
""))
        item = self.tableWidget.horizontalHeaderItem(12)
        item.setText(_translate("PipeTally", "Depth(mm)\n"
""))
        item = self.tableWidget.horizontalHeaderItem(13)
        item.setText(_translate("PipeTally", "Type\n"
""))
        item = self.tableWidget.horizontalHeaderItem(14)
        item.setText(_translate("PipeTally", "ERF (ASME B31G)\n"
""))
        item = self.tableWidget.horizontalHeaderItem(15)
        item.setText(_translate("PipeTally", "Psafe (ASME B31G) Barg\n"
""))
        item = self.tableWidget.horizontalHeaderItem(16)
        item.setText(_translate("PipeTally", "Latitude\n"
""))
        item = self.tableWidget.horizontalHeaderItem(17)
        item.setText(_translate("PipeTally", "Longitude\n"
""))

        
    def load_excel_data(self):
        # Open a file dialog to allow the user to select an Excel file
        file_path, _ = QFileDialog.getOpenFileName(None, "Open Excel File", "", "Excel Files (*.xlsx *.xls)")

        # Check if the user selected a file
        if file_path:
                try:
                        # Load the selected Excel file
                        workbook = load_workbook(file_path)  # Load the selected file
                        sheet = workbook.active  # Get the active sheet

                        # Define column indices as per the headers in your tableWidget
                        column_mapping = {
                                0: "Abs. Distance (m)",
                                1: "Distance to U/S GW(m)",
                                2: "Pipe Number",
                                3: "Pipe Length(m)",
                                4: "Feature Identification",
                                5: "Feature Type",
                                6: "Dimensions Classification",
                                7: "Orientation o' clock",
                                8: "Length(mm)",
                                9: "Width(mm)",
                                10: "WT (mm)",
                                11: "Depth %",
                                12: "Depth(mm)",
                                13: "Type",
                                14: "ERF (ASME B31G)",
                                15: "Psafe (ASME B31G) Barg",
                                16: "Latitude",
                                17: "Longitude"
                        }
                
                        # Set number of columns and rows
                        self.tableWidget.setColumnCount(len(column_mapping))
                        self.tableWidget.setRowCount(sheet.max_row)
                
                        # Populate the table with Excel data
                        for row_num, row_data in enumerate(sheet.iter_rows(values_only=True)):
                                for col_num, cell_data in enumerate(row_data):
                                        item = QTableWidgetItem(str(cell_data) if cell_data is not None else "")
                                        self.tableWidget.setItem(row_num, col_num, item)
                
                except Exception as e:
                        print(f"Error loading Excel file: {e}")
        else:
                print("No file selected.")



        
if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    PipeTally = QtWidgets.QWidget()
    ui = Ui_PipeTally()
    ui.setupUi(PipeTally)
    PipeTally.show()
    sys.exit(app.exec())
